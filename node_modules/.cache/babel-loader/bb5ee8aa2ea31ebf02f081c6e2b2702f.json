{"ast":null,"code":"import { createSlice, createSelector, createAsyncThunk, createEntityAdapter } from '@reduxjs/toolkit';\nimport { sub } from 'date-fns';\nimport { client } from '../../api/client';\nconst postsAdapter = createEntityAdapter({\n  sortComparer: (a, b) => b.date.localeCompare(a.date)\n});\nconst initialState = postsAdapter.getInitialState({\n  status: 'idle',\n  error: null\n});\nexport const fetchPosts = createAsyncThunk('https://jsonplaceholder.typicode.com/posts/fetchPosts', async () => {\n  const response = await client.get('https://jsonplaceholder.typicode.com/posts');\n  return response.data;\n});\nexport const addNewPost = createAsyncThunk('posts/addNewPost', // The payload creator receives the partial `{title, content, user}` object\nasync initialPost => {\n  // We send the initial data to the fake API server\n  const response = await client.post('https://jsonplaceholder.typicode.com/posts', initialPost); // The response includes the complete post object, including unique ID\n\n  return response.data;\n});\nconst postsSlice = createSlice({\n  name: 'posts',\n  initialState,\n  reducers: {\n    postUpdated(state, action) {\n      const {\n        id,\n        title,\n        body\n      } = action.payload;\n      const existingPost = state.entities[id];\n\n      if (existingPost) {\n        existingPost.title = title;\n        existingPost.body = body;\n      }\n    },\n\n    reactionAdded(state, action) {\n      const {\n        postId,\n        reaction\n      } = action.payload;\n      const existingPost = state.entities[postId];\n\n      if (existingPost) {\n        existingPost.reactions[reaction]++;\n      }\n    }\n\n  },\n\n  extraReducers(builder) {\n    builder.addCase(fetchPosts.pending, (state, action) => {\n      state.status = 'loading';\n    }).addCase(fetchPosts.fulfilled, (state, action) => {\n      state.status = 'succeeded'; // Add any fetched posts to the array\n      // Use the `upsertMany` reducer as a mutating update utility\n\n      postsAdapter.upsertMany(state, action.payload);\n    }).addCase(fetchPosts.rejected, (state, action) => {\n      state.status = 'failed';\n      state.error = action.error.message;\n    }).addCase(addNewPost.fulfilled, postsAdapter.addOne);\n  }\n\n});\nexport const {\n  postAdded,\n  postUpdated,\n  reactionAdded\n} = postsSlice.actions;\nexport default postsSlice.reducer; // Export the customized selectors for this adapter using `getSelectors`\n\nexport const {\n  selectAll: selectAllPosts,\n  selectById: selectPostById,\n  selectIds: selectPostIds // Pass in a selector that returns the posts slice of state\n\n} = postsAdapter.getSelectors(state => state.posts);\nexport const selectPostsByUser = createSelector([selectAllPosts, (state, userId) => userId], (posts, userId) => posts.filter(post => post.user === userId));","map":{"version":3,"sources":["C:/Users/Administrator/Desktop/Practice_ReactJS/RTK_Query/src/features/posts/postsSlice.js"],"names":["createSlice","createSelector","createAsyncThunk","createEntityAdapter","sub","client","postsAdapter","sortComparer","a","b","date","localeCompare","initialState","getInitialState","status","error","fetchPosts","response","get","data","addNewPost","initialPost","post","postsSlice","name","reducers","postUpdated","state","action","id","title","body","payload","existingPost","entities","reactionAdded","postId","reaction","reactions","extraReducers","builder","addCase","pending","fulfilled","upsertMany","rejected","message","addOne","postAdded","actions","reducer","selectAll","selectAllPosts","selectById","selectPostById","selectIds","selectPostIds","getSelectors","posts","selectPostsByUser","userId","filter","user"],"mappings":"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","sourcesContent":["import { createSlice, createSelector, createAsyncThunk, createEntityAdapter } from '@reduxjs/toolkit';\r\nimport { sub } from 'date-fns'\r\nimport { client } from '../../api/client'\r\n\r\n\r\nconst postsAdapter = createEntityAdapter({\r\n  sortComparer: (a, b) => b.date.localeCompare(a.date)\r\n})\r\n\r\nconst initialState = postsAdapter.getInitialState({\r\n  status: 'idle',\r\n  error: null\r\n})\r\n\r\nexport const fetchPosts = createAsyncThunk('https://jsonplaceholder.typicode.com/posts/fetchPosts', async () => {\r\n  const response = await client.get('https://jsonplaceholder.typicode.com/posts')\r\n  return response.data\r\n})\r\n\r\nexport const addNewPost = createAsyncThunk(\r\n  'posts/addNewPost',\r\n  // The payload creator receives the partial `{title, content, user}` object\r\n  async initialPost => {\r\n    // We send the initial data to the fake API server\r\n    const response = await client.post('https://jsonplaceholder.typicode.com/posts', initialPost)\r\n    // The response includes the complete post object, including unique ID\r\n    return response.data\r\n  }\r\n)\r\n\r\nconst postsSlice = createSlice({\r\n  name: 'posts',\r\n  initialState,\r\n  reducers: {\r\n    postUpdated(state, action) {\r\n      const { id, title, body } = action.payload\r\n      const existingPost = state.entities[id]\r\n      if (existingPost) {\r\n        existingPost.title = title\r\n        existingPost.body = body\r\n      }\r\n    },\r\n    reactionAdded(state, action) {\r\n      const { postId, reaction } = action.payload\r\n      const existingPost = state.entities[postId]\r\n      if (existingPost) {\r\n        existingPost.reactions[reaction]++\r\n      }\r\n    }\r\n  },\r\n  extraReducers(builder) {\r\n    builder\r\n      .addCase(fetchPosts.pending, (state, action) => {\r\n        state.status = 'loading'\r\n      })\r\n      .addCase(fetchPosts.fulfilled, (state, action) => {\r\n        state.status = 'succeeded'\r\n        // Add any fetched posts to the array\r\n        // Use the `upsertMany` reducer as a mutating update utility\r\n        postsAdapter.upsertMany(state, action.payload)\r\n      })\r\n      .addCase(fetchPosts.rejected, (state, action) => {\r\n        state.status = 'failed'\r\n        state.error = action.error.message\r\n      })\r\n      .addCase(addNewPost.fulfilled, postsAdapter.addOne)\r\n  }\r\n})\r\n\r\nexport const { postAdded, postUpdated, reactionAdded } = postsSlice.actions\r\n\r\nexport default postsSlice.reducer\r\n\r\n// Export the customized selectors for this adapter using `getSelectors`\r\nexport const {\r\n  selectAll: selectAllPosts,\r\n  selectById: selectPostById,\r\n  selectIds: selectPostIds\r\n  // Pass in a selector that returns the posts slice of state\r\n} = postsAdapter.getSelectors(state => state.posts)\r\n\r\nexport const selectPostsByUser = createSelector(\r\n  [selectAllPosts, (state, userId) => userId],\r\n  (posts, userId) => posts.filter(post => post.user === userId)\r\n)  "]},"metadata":{},"sourceType":"module"}